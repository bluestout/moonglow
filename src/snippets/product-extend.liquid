
{% form 'product', product, data-product-form: '', data-product-handle: product.handle, data-enable-history-state: 'true' %}
{% if flag == true %}

  {% assign number = 0 %}
  {% if count > 0 %}
    <div class="js product_moon" p_num ="{{ count }}">
      <h6 class="stage-title brand"><strong class="brand">step {{ number | plus: 1 }} : </strong> MOON PHASE</h6>
      {% assign number = number | plus:1 %}
      {% for i in (1..count) %}
          {% assign j =  i | replace: 1, "1st" | replace: 2, "2nd" | replace: 3, "3rd" | replace: 4, "4th" | replace: 5, "5th" | replace: 6, "6th" %}
          <div class="select-pannel moon_phase_image">
            <div class="mark-img">
              <img data-src="{{ 'PL.png' | asset_img_url: '50x' }}" class="moon_image lazyload" alt="Moon phase icon" data-sizes="auto">
            </div>
            <div class="form-control">
              <svg width="18px" height="21px" viewBox="0 0 18 21" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <!-- Generator: sketchtool 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                <title>37B80903-4F32-43AF-9DD3-E0C91892A30A</title>
                <desc>Created with sketchtool.</desc>
                <defs></defs>
                <g id="style-guide" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g id="icons" transform="translate(-404.000000, -30.000000)" fill="#2E4676" fill-rule="nonzero">
                        <g id="calender_ico" transform="translate(404.000000, 30.000000)">
                            <path d="M2,5 L2,19 L16,19 L16,5 L2,5 Z M0,3 L18,3 L18,21 L0,21 L0,3 Z" id="Rectangle-14"></path>
                            <path d="M5,3.5 L5,7 L6,6 L4,6 L5,7 L5,3.5 Z M5,3.5 L5,0 L4,1 L6,1 L5,0 L5,3.5 Z M4,0 L6,0 L6,7 L4,7 L4,0 Z" id="Rectangle-5"></path>
                            <path d="M13,3.5 L13,7 L14,6 L12,6 L13,7 L13,3.5 Z M13,3.5 L13,0 L12,1 L14,1 L13,0 L13,3.5 Z M12,0 L14,0 L14,7 L12,7 L12,0 Z" id="Rectangle-5"></path>
                            <polygon id="Line-5" points="0 12 0 10 17 10 17 12"></polygon>
                        </g>
                    </g>
                </g>
            </svg>

              <input type="text" class="moon_phase phase-{{i}}" data-target="phase-{{i}}" readonly name="properties[Phase{{i}}]" placeholder="select {{ j }} moon phase date" id="datepicker"/>
            </div>
          </div>
          <a class="save-date phase-{{i}}-save-date-button">Save date</a>
          <div class="slect-pannel moon_phase_cookie">
            <div class="form-control">
              <select class="saved-dates" data-target="phase-{{i}}">

              </select>
            </div>
          </div>
      {% endfor %}

    </div>
  {% endif %}
  {% for option in product.options_with_values %}
    {% if option.name != 'Title' %}
      <div class="js {% if option.name == 'Chain Length' %}chain-size {% else %} {{option.name | replace: ' ', '-'}} {% endif %}">
        {% if forloop.index0 > 0 %}
          <h6 class="stage-title brand uppercase"><strong class="brand">step {{ number | plus: 1 }} : </strong>{{ option.name }}</h6>
          {% assign number = number | plus:1 %}
          {% assign i = 0 %}
          {%- assign optName = 'options' | append: forloop.index -%}
          {%- assign option_values = [optName] | default: option.values -%}
          {%- for value in option_values -%}
            <label for="{{ value | remove: '"' | remove: ' ' }}" class="{% if i == 0 %}active{% endif %}">{{ value }}</label>
            {% assign i = i | plus:1 %}
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}
  {% endfor %}

  <div class="js">
    <h6 class="stage-title brand uppercase"><strong>step {{ number | plus: 1 }} : </strong> add custom engraving</h6>
    <div class="select-pannel">
      <div class="mark-img">
        <img data-src="{{ 'jewelry.png' | asset_img_url: '50x' }}" class="moon_image lazyload" alt="engraving icon" data-sizes="auto">
      </div>
      <div class="form-control">
        <a class="engrange_checkbox">I'd like to add engraved tag</a>
      </div>
    </div>
    <div class="engraving_form">
      <input type="text" placeholder="" name="properties[Engraving]" class="engrange">
      <p>Engraving costs are based on the number of characters.</p>
      <ul class="engraving-pricing">
        <li> 1-5 = $10</li>
        <li>6-10 = $15</li>
        <li>11-20 = $20</li>
      </ul>
    </div>
  </div>

  {% assign variant = bold_selected_or_first_available_variant %}
  <div class="variants">
    {% for variant in product.variants %}
      {%- include 'bold-variant' with variant, hide_action: 'skip' -%}
      <input type="hidden" value="{{ variant.id }}" id='{{variant.option1 | remove: '"' | remove: ' '}}-{{variant.option2 | remove: '"' | remove: ' '}}'>
    {% endfor %}
  </div>
  <input type="hidden" name="form_type" value="product">
  <input type="hidden" name="utf8" value="âœ“">
  <input type="hidden" id="variant_id" name="id" value="{{variant.id}}">
  <input type="hidden" id="Quantity_product" name="quantity" value="1" min="1">

  {% capture add_to_cart_label %}{% if collection_handles contains 'pre-order' %}{{ 'collections.general.pre_order' | t }}{% else %}{{ 'products.product.add_to_cart' | t }}{% endif %}{% endcapture %}
  <button type="button" name="add" {% if product.available %}disable{% endif %} class="button ajax-submit add_cart {% if product.available == false %}disabled {% endif %}" data-label={{ add_to_cart_label | json }}>
    <span class="text">
      {% if product.available %}{{ add_to_cart_label }}{% else %}{{ settings.sold_out_text }}{% endif %}
    </span>
    <span class="checkmark">adding cart...</span>
  </button>
  {% include 'wishlist-btn' %}
  <div class="alert-message animated alert-danger bounceIn bounceOut product-alert">please complete all steps.</div>
  <div class="sub-desc">
    {% assign day = 86400 %}
    {% assign days = 3 %}
    {% assign final_day = day | times:days %}

    {% assign day = 86400 %}
    {%- assign today = 'now' | date: "%s"  -%}
    {% assign days = 7 %}
    {% if current_store =='usa' %}
    {%- for i in (1..3) -%}
    {%- assign today =  today | plus:86400 -%}
    {%- assign current_day = today | date:'%a' -%}
    {%- if current_day == 'Sat' %}
    {%- assign today =  today | plus:172800 -%}
    {%- endif -%}
    {%- endfor -%}
    {%- else -%}
    {%- for i in (1..7) -%}
    {%- assign today =  today | plus:86400 -%}
    {%- assign current_day = today | date:'%a' -%}
    {%- if current_day == 'Sat' %}
    {%- assign today =  today | plus:172800 -%}
    {%- endif -%}
    {%- endfor -%}
    {%- endif -%}
    {% assign d =  today | date: "%b %d, %Y" %}
    <div  class="product_date">
      <span> {% if template contains 'product' %} <b class ="get_it"> Get it as soon as: </b> {% else %} Estimated delivery date: {% endif%}<b>{{d}}</b>
      {% if current_store == 'usa' %}  with express shipping. {% else %} if you order today. {% endif %}
      </span>
      {% if bold_price > 5000 %}
        <a href="">Free Standard Shipping for this product!</a>
      {% endif %}

    </div>
  </div>

{% else %}
  <div class="moon_class" data-moon="no"></div>
  <div class="single-add-cart">
    {% if product.tags contains 'custom_bracelete'%}
      <label class="mark">Birthstone</label>
    {% else %}
        <label class="mark">select</label>
    {% endif %}
    <select name="id[]" id="productSelect" class="product-single__variants{% if bold_variants_size == 1 and bold_selected_or_first_available_variant.title contains 'Default Title' %} hide{% endif %}" aria-label="product selection">
      {% for variant in product.variants %}
        {%- include 'bold-variant' with variant, hide_action: 'skip' -%}
      {% if variant.available %}
      <option {% if variant == bold_selected_or_first_available_variant %} selected="selected" {% endif %} data-sku="{{ variant.sku }}" value="{{ variant.id }}">{{ variant.title }}</option>
      {% else %}
      <option disabled="disabled" data-title='{{variant.title}}'>
        {{ variant.title }}
      </option>
      {% endif %}
      {% endfor %}
    </select>
    {% include 'prod-enhancers' %}
      <div class="line"></div>
    {% if section.settings.enable_free_giftbox %}
      <div class="custom-input-wrapper phase-checkbox custom-checkbox gift_box">
        <input type="checkbox" id="giftbox_check" data-product="{{all_products[section.settings.choose_gift_prod].title}}">
        <label for="giftbox_check"> {{section.settings.gift_note}}</label>
      </div>
    {% endif %}
    {% unless product.handle == 'moon-phase-hidden' %}
      {% if bold_price > 0 %}
        {% capture add_to_cart_label %}{% if collection_handles contains 'pre-order' %}{{ 'collections.general.pre_order' | t }}{% else %}{{ 'products.product.add_to_cart' | t }}{% endif %}{% endcapture %}
        <button type="button" name="add" class="button ajax-submit add_cart {% if product.available == false %}disabled {% endif %}" data-label={{ add_to_cart_label | json }}>
          <span class="text">
            {% if product.available %}{{ add_to_cart_label }}{% else %}{{ settings.sold_out_text }}{% endif %}
          </span>
          <span class="checkmark">adding cart...</span>
        </button>
      {% endif %}
    {% endunless %}
    <div class="alert-message animated alert-danger bounceIn bounceOut product-alert">Please complete all steps.</div>
  </div>
{% endif %}
{% endform %}

{% unless bundle_loaded == 'true' %}
{% include 'shappify-bdl-load-bundle' %}
{% assign bundle_loaded = 'true' %}
{% endunless %}
