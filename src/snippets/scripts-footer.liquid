<script defer="defer">
Weglot.setup({
    live: true,
    api_key: "wg_a0a65cb80fef26d4496d1d1640dbc4ec0",
    originalLanguage: "en",
    destinationLanguages : "fr,nl,de,es,pt,da,hi,he,it,ar,ja,id,pl,ru,sv,ur,tr,ko,cs,gd,no,pa,ro,hu,bn,zh",
    styleOpt : { fullname : false , withname : true , is_dropdown : true , classF : "wg-flags flag-3 " },
    exceptions: "",
    excludePaths: "",
    dynamic: "",
    autoSwitch: true,
    translateSearch: false,
    switchers: [{"styleOpt":{"fullname":false,"withname":true,"is_dropdown":true,"classF":"wg-flags flag-3 "},"containerCss":"","target":".translate_field","sibling":null}]
});

{% if current_store == 'usa' %}
window.asset_host='//cdn.jst.ai/';
(function(i,s,o,g,r,a,m){i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)};a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script',asset_host+'vck.js','juapp');
{% endif %}

document.documentElement.className = document.documentElement.className.replace('no-js', '');

</script>

<script>

!function(w,d){if(!w.rdt){var p=w.rdt=function(){p.sendEvent?p.sendEvent.apply(p,arguments):p.callQueue.push(arguments)};p.callQueue=[];var t=d.createElement("script");t.src="https://www.redditstatic.com/ads/pixel.js",t.async=!0;var s=d.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}}(window,document);rdt('init','t2_59ccg5t5');rdt('track', 'PageVisit');

{% if customer %}

    simply.wishlistGuId = "{{shop.metafields.moon_wishlist_GUID.guid}}";
    simply.custEmail = {{- customer.email | json-}};
    simply.wishlistCustomerId = {{customer.id}};

{% endif %}

simply.cartJson = {{cart | json }};

window.theme = {
  strings: {
    addToCart: {{ 'products.product.add_to_cart' | t | json }},
    soldOut: {{ 'products.product.sold_out' | t | json }},
    unavailable: {{ 'products.product.unavailable' | t | json }}
  },
  moneyFormat: {{ shop.money_format | json }}
};

{% if current_store == 'usa' %}
window.ju_num="7B79D59A-6E48-4FDA-A755-E226FDA489E0";
{% endif %}

{% if template contains 'product' %}
    var json_product = {{ product | json }};
    var ecomm_prodid=[];
    for(var i=0; i<json_product.variants.length; i++)
      ecomm_prodid.push('shopify_US_{{product.id}}_'+json_product.variants[i].id);

    try{
      var google_tag_params = {
        ecomm_prodid: ecomm_prodid,
        ecomm_pagetype: 'product',
        ecomm_totalvalue: parseFloat({% assign geolizr_price =  product.price  %}{% include 'geolizr-currency' with geolizr_price %}{{ product.price | money_without_currency | prepend: geolizr_prepend_code | append: geolizr_append_code | remove: ","}})

      };
    }
    catch(e){
      console.log(e);
    }
{% elsif template contains 'collection' %}

    try{
      var google_tag_params = {
        ecomm_pagetype: 'category'
      };
    }
    catch(e){

    }

{% elsif template contains 'cart' %}

    var id = new Array();
    {% for item in cart.items %}
    id.push('shopify_US_{{item.product.id}}_{{item.variant.id}}');
    {% endfor %}
    try{
      var google_tag_params = {
        ecomm_prodid: id,
        ecomm_pagetype: 'cart',
        ecomm_totalvalue: parseFloat('{{ cart.total_price | money_without_currency | remove: ","}}')
      }
      catch(e){

      }
    };

{% elsif template contains 'search' %}

    try{
      var google_tag_params = {
        ecomm_pagetype: 'searchresults'
      };
    }
    catch(e){

    }

{% elsif template contains 'index' %}

    var google_tag_params = {
      ecomm_pagetype: 'home'
    };

{% else %}

    var google_tag_params = {
      ecomm_pagetype: 'other'
    };

{% endif %}

  var _learnq = _learnq || [];

  _learnq.push(['account', 'KLsXGh']);

  (function () {
    var b = document.createElement('script'); b.type = 'text/javascript'; b.async = true;
    b.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'a.klaviyo.com/media/js/analytics/analytics.js';
    var a = document.getElementsByTagName('script')[0]; a.parentNode.insertBefore(b, a);
  })();


  (function(h,o,t,j,a,r){
    h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
    h._hjSettings={hjid:385707,hjsv:6};
    a=o.getElementsByTagName('head')[0];
    r=o.createElement('script');r.async=1;
    r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
    a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');

  (function(h,o,t,j,a,r){
    h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
    h._hjSettings={hjid:815861,hjsv:6};
    a=o.getElementsByTagName('head')[0];
    r=o.createElement('script');r.async=1;
    r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
    a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');

  // Liquid variables:
  var afterpay_product = {{ product | json }};
  var afterpay_cart_total_price = {{ cart.total_price | json }};

  simply.customer_id = '';
  {% if customer %}
  {% assign cust_id = customer.id %}
  simply.customer_id = {{ cust_id }};
  {% endif %}
  {% if template contains 'index' %}
  simply.homePage = true;
  {% else %}
  simply.homePage = false;
  {% endif %}
  {% if template contains 'page.moon-calculator' %}
  simply.moonCalcPage = true;
  {% else %}
  simply.moonCalcPage = false;
  {% endif %}

{% if current_store == 'usa' %}
    {% if template contains 'product' or template contains 'collection' or template contains 'index' or template contains 'search' %}

        gtag('event', 'page_view', {
          'send_to': '{{ settings.awtag }}',
          'ecomm_pagetype': '{% if template contains 'collection' %}category{% elsif template contains 'product' %}product{% elsif template contains 'search' %}{% elsif template contains 'index' %}home{% endif %}',
          {% if template contains 'product' %}
          'ecomm_prodid': 'shopify_US_{{ product.id }}_{{ product.selected_or_first_available_variant.id }}',
          {% endif %}
          {% if template contains 'product' %}'ecomm_totalvalue': {{ product.price_min | money_without_currency | remove:',' }},{% endif %}
          {% if template contains 'product' %}'ecomm_category': "{{ product.type }}"{% endif %}
        });
  {% endif %}
{% endif %}

{% if template contains 'product' %}

  var atcButtonID = "add_to_cart_btn";

  var atcButton = document.getElementById(atcButtonID);
  if(atcButton){
    atcButton.addEventListener("click", function(event) {
      var cartValue = {{ product.selected_or_first_available_variant.price }}/100;
                  var productId = {{ product.selected_or_first_available_variant.id }};
                  var productType = "{{ product.type }}";
                  var currency = "{{ shop.currency }}";
      var tagId = "AW-996068966/iHXNCPfrvckBEOac-9oD";

      var tagSegments = tagId.substr(3).split('/');
      var conversionId = tagSegments[0];
      var conversionLabel = tagSegments[1];

      gtag('config', 'AW-'+conversionId);
      gtag('event', 'conversion', {
          'send_to': 'AW-'+conversionId+'/'+conversionLabel,
          'value': cartValue,
          'currency': currency
      });
    });
  }
{% endif %}
</script>
